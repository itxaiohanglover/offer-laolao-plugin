<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Offer捞捞</title>
    <!-- ============================================
         样式文件引入
         所有样式已模块化拆分到 styles/ 目录
         ============================================ -->
    <link rel="stylesheet" href="styles/popup.css" />
    <!-- 
      CSS 文件结构说明：
      - styles/variables.css  - CSS 变量定义（颜色、圆角、阴影等）
      - styles/base.css       - 基础样式（reset、body、滚动条等）
      - styles/layout.css     - 布局样式（header、content-panel、section等）
      - styles/forms.css      - 表单样式（form-group、input、textarea等）
      - styles/buttons.css    - 按钮样式（add-btn、remove-btn、action-buttons等）
      - styles/components.css - 组件样式（动态列表、通知、上传区域等）
      - styles/popup.css      - 主样式文件（导入所有模块）
      
      所有内联样式已迁移到外部 CSS 文件，提高可维护性和可读性。
    -->
  </head>
  <body>
    <!-- ============================================
         页面头部区域
         ============================================ -->
    <div class="header">
      <img src="../../icons/icon_48x48.png" alt="Logo" class="header-logo" />
      <div>
        <h1 class="header-title">Offer 捞捞</h1>
        <p class="header-subtitle">简历自动填写助手，让求职更轻松 ✨</p>
      </div>
    </div>

    <!-- ============================================
         模式切换选项卡
         ============================================ -->
    <div class="mode-tabs">
      <button id="mode-manual" class="active" data-mode="manual">
        📝 简历填写
      </button>
      <button id="mode-settings" data-mode="settings">⚙️ 设置</button>
    </div>

    <!-- ============================================
         手动填写内容面板（默认显示）
         ============================================ -->
    <div id="manual-content" class="content-panel">
      <h3>填写您的简历</h3>

      <!-- 简历上传功能 -->
      <div class="section">
        <h4 class="upload-title">智能上传简历</h4>
        <div id="drop-area" class="drop-area">
          <input
            type="file"
            id="file-input"
            style="display: none"
            accept=".pdf,.docx,.doc,.json,.txt"
          />
          <div class="drop-area-icon">📄</div>
          <p class="drop-area-text">点击或拖拽文件到此处上传</p>
          <p class="drop-area-hint">
            支持 PDF、DOCX、JSON 格式，自动解析填充表单
          </p>
          <p class="drop-area-warning">⚠️ 请先在"设置"中配置简历解析 API</p>
        </div>
        <div id="parse-result" class="parse-result">
          上传文件后将显示解析结果
        </div>
      </div>

      <!-- ============================================
           顶部操作按钮组
           ============================================ -->
      <div class="action-buttons">
        <button id="fill-current-page" class="btn-primary">📋 预填</button>
        <button id="optimize-resume" class="btn-ai">✨ AI优化</button>
        <button id="save-resume" class="btn-secondary">💾 保存</button>
        <button id="reset-resume" class="btn-danger">🗑️ 重置</button>
        <button id="export-resume" class="btn-accent">📤 导出</button>
      </div>

      <!-- ============================================
           基本信息区块
           ============================================ -->
      <div class="section">
        <h4 class="basic-title">基本信息</h4>
        <div class="form-group">
          <label for="name">姓名</label>
          <input type="text" id="name" placeholder="请输入姓名" />
        </div>
        <div class="form-group">
          <label for="gender">性别</label>
          <select id="gender">
            <option value="">请选择</option>
            <option value="男">男</option>
            <option value="女">女</option>
          </select>
        </div>
        <div class="form-group">
          <label for="birth-date">出生日期</label>
          <input type="date" id="birth-date" />
        </div>
        <div class="form-group">
          <label for="phone">手机号码</label>
          <input type="tel" id="phone" placeholder="请输入手机号码" />
        </div>
        <div class="form-group">
          <label for="email">电子邮箱</label>
          <input type="email" id="email" placeholder="请输入电子邮箱" />
        </div>
        <div class="form-group">
          <label for="id-card">身份证号</label>
          <input type="text" id="id-card" placeholder="请输入身份证号" />
        </div>
        <div class="form-group">
          <label for="location">所在地</label>
          <input type="text" id="location" placeholder="请输入所在地" />
        </div>
        <div class="form-group">
          <label for="political-status">政治面貌</label>
          <select id="political-status">
            <option value="">请选择</option>
            <option value="群众">群众</option>
            <option value="团员">团员</option>
            <option value="党员">党员</option>
          </select>
        </div>
      </div>

      <!-- ============================================
           求职期望区块
           ============================================ -->
      <div class="section">
        <h4 class="job-title">求职期望</h4>
        <div class="form-group">
          <label for="expected-position">期望职位</label>
          <input
            type="text"
            id="expected-position"
            placeholder="请输入期望职位"
          />
        </div>
        <div class="form-group">
          <label for="expected-industry">期望行业</label>
          <input
            type="text"
            id="expected-industry"
            placeholder="请输入期望行业"
          />
        </div>
        <div class="form-group">
          <label for="expected-salary">期望薪资</label>
          <input
            type="text"
            id="expected-salary"
            placeholder="请输入期望薪资"
          />
        </div>
        <div class="form-group">
          <label for="expected-location">期望地点</label>
          <input
            type="text"
            id="expected-location"
            placeholder="请输入期望地点"
          />
        </div>
        <div id="internship-specific" class="form-group hidden">
          <label for="internship-duration">实习时长</label>
          <input
            type="text"
            id="internship-duration"
            placeholder="请输入实习时长"
          />
        </div>
        <div id="part-time-specific" class="form-group hidden">
          <label for="available-time">可工作时间</label>
          <input
            type="text"
            id="available-time"
            placeholder="请输入可工作时间"
          />
        </div>
      </div>

      <!-- ============================================
           教育经历区块
           ============================================ -->
      <div class="section">
        <h4 class="edu-title">教育经历</h4>
        <div id="education-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>学校名称</label>
              <input
                type="text"
                name="education[0][school]"
                placeholder="请输入学校名称"
              />
            </div>
            <div class="form-group">
              <label>专业</label>
              <input
                type="text"
                name="education[0][major]"
                placeholder="请输入专业"
              />
            </div>
            <div class="form-group">
              <label>学历</label>
              <select name="education[0][degree]">
                <option value="">请选择</option>
                <option value="专科">专科</option>
                <option value="本科">本科</option>
                <option value="硕士">硕士</option>
                <option value="博士">博士</option>
              </select>
            </div>
            <div class="form-group">
              <label>排名</label>
              <input
                type="text"
                name="education[0][rank]"
                placeholder="请输入排名（如：前5%）"
              />
            </div>
            <div class="form-group-inline">
              <div class="form-group">
                <label>入学时间</label>
                <input type="date" name="education[0][start-date]" />
              </div>
              <div class="form-group">
                <label>毕业时间</label>
                <input type="date" name="education[0][end-date]" />
              </div>
            </div>
          </div>
        </div>
        <button id="add-education" class="add-btn">+ 添加教育经历</button>
      </div>

      <!-- ============================================
           实习/工作经历区块
           ============================================ -->
      <div class="section">
        <h4 class="work-title">实习/工作经历</h4>
        <div id="internship-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>公司名称</label>
              <input
                type="text"
                name="internship[0][company]"
                placeholder="请输入公司名称"
              />
            </div>
            <div class="form-group">
              <label>职位</label>
              <input
                type="text"
                name="internship[0][position]"
                placeholder="请输入职位"
              />
            </div>
            <div class="form-group-inline">
              <div class="form-group">
                <label>开始时间</label>
                <input type="date" name="internship[0][start-date]" />
              </div>
              <div class="form-group">
                <label>结束时间</label>
                <input type="date" name="internship[0][end-date]" />
              </div>
            </div>
            <div class="form-group">
              <label>工作描述</label>
              <textarea
                name="internship[0][description]"
                placeholder="请输入工作描述"
              ></textarea>
            </div>
          </div>
        </div>
        <button id="add-internship" class="add-btn">+ 添加工作经历</button>
      </div>

      <!-- ============================================
           项目经历区块
           ============================================ -->
      <div class="section">
        <h4 class="project-title">项目经历</h4>
        <div id="project-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>项目名称</label>
              <input
                type="text"
                name="project[0][project-name]"
                placeholder="请输入项目名称"
              />
            </div>
            <div class="form-group">
              <label>担任角色</label>
              <input
                type="text"
                name="project[0][role]"
                placeholder="请输入担任角色"
              />
            </div>
            <div class="form-group">
              <label>项目时间</label>
              <input
                type="text"
                name="project[0][project-time]"
                placeholder="请输入项目时间"
              />
            </div>
            <div class="form-group">
              <label>项目描述</label>
              <textarea
                name="project[0][project-desc]"
                placeholder="请输入项目描述"
              ></textarea>
            </div>
            <div class="form-group">
              <label>职责描述</label>
              <textarea
                name="project[0][responsibilities]"
                placeholder="请输入职责描述"
              ></textarea>
            </div>
          </div>
        </div>
        <button id="add-project" class="add-btn">+ 添加项目经历</button>
      </div>

      <!-- ============================================
           技能信息区块
           ============================================ -->
      <div class="section">
        <h4 class="skill-title">技能信息</h4>
        <div id="skills-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>技能名称</label>
              <input
                type="text"
                name="skills[0][name]"
                placeholder="请输入技能名称"
              />
            </div>
            <div class="form-group">
              <label>技能水平</label>
              <select name="skills[0][level]">
                <option value="">请选择</option>
                <option value="初级">初级</option>
                <option value="中级">中级</option>
                <option value="高级">高级</option>
                <option value="专家">专家</option>
              </select>
            </div>
          </div>
        </div>
        <button id="add-skill" class="add-btn">+ 添加技能</button>
      </div>

      <!-- ============================================
           语言能力区块
           ============================================ -->
      <div class="section">
        <h4 class="lang-title">语言能力</h4>
        <div id="language-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>语言名称</label>
              <input
                type="text"
                name="language[0][name]"
                placeholder="请输入语言名称（如：英语、日语）"
              />
            </div>
            <div class="form-group">
              <label>掌握程度</label>
              <select name="language[0][proficiency]">
                <option value="">请选择</option>
                <option value="入门">入门</option>
                <option value="基础">基础</option>
                <option value="熟练">熟练</option>
                <option value="精通">精通</option>
              </select>
            </div>
            <div class="form-group">
              <label>证书</label>
              <input
                type="text"
                name="language[0][certificate]"
                placeholder="请输入证书名称（如：大学英语六级）"
              />
              <input
                type="file"
                name="language[0][certificate-file]"
                accept=".pdf,.jpg,.png"
                style="margin-top: 8px"
              />
            </div>
          </div>
        </div>
        <button id="add-language" class="add-btn">+ 添加语言能力</button>
      </div>

      <!-- ============================================
           自定义字段区块
           ============================================ -->
      <div class="section">
        <h4 class="custom-title">自定义字段</h4>
        <div id="custom-field-list" class="dynamic-list">
          <div class="dynamic-item">
            <button class="remove-btn">删除</button>
            <div class="form-group">
              <label>字段名称</label>
              <input
                type="text"
                name="custom[0][name]"
                placeholder="请输入字段名称"
              />
            </div>
            <div class="form-group">
              <label>字段内容</label>
              <textarea
                name="custom[0][content]"
                placeholder="请输入字段内容"
              ></textarea>
            </div>
          </div>
        </div>
        <button id="add-custom-field" class="add-btn">+ 添加自定义字段</button>
      </div>

      <!-- ============================================
           自我描述区块
           ============================================ -->
      <div class="section">
        <h4 class="intro-title">自我描述</h4>
        <div class="form-group">
          <textarea
            id="self-intro"
            placeholder="请输入自我描述，展示您的优势和特点"
          ></textarea>
        </div>
      </div>
    </div>

    <!-- ============================================
         设置内容面板
         ============================================ -->
    <div id="settings-content" class="content-panel hidden">
      <h3>设置</h3>

      <!-- AI 模型配置 -->
      <div class="section settings-section">
        <h4 class="ai-title">AI 模型配置</h4>
        <p class="settings-hint" style="margin-top: -8px; margin-bottom: 16px">
          用于简历内容智能优化
        </p>

        <div class="form-group">
          <label for="model-provider">模型提供商</label>
          <select id="model-provider">
            <option value="deepseek">DeepSeek</option>
            <option value="kimi">Kimi (月之暗面)</option>
            <option value="qwen">通义千问 (阿里云)</option>
            <option value="volcengine">火山引擎 (豆包)</option>
            <option value="zhipu">智谱 AI (GLM)</option>
            <option value="baichuan">百川智能</option>
            <option value="custom">自定义 (OpenAI 兼容)</option>
          </select>
          <p class="settings-hint">选择您要使用的 AI 模型服务商</p>
        </div>

        <div class="form-group">
          <label for="model-select">选择模型</label>
          <select id="model-select">
            <option value="">请先选择模型提供商</option>
          </select>
          <p class="settings-hint">不同模型有不同的能力和价格</p>
        </div>

        <div class="form-group">
          <label for="model-api-key">API Key</label>
          <input
            type="password"
            id="model-api-key"
            placeholder="请输入模型 API 密钥"
          />
          <p class="settings-hint">在对应平台的控制台获取 API Key</p>
        </div>

        <div id="custom-url-group" class="form-group hidden">
          <label for="model-custom-url">自定义 API URL</label>
          <input
            type="text"
            id="model-custom-url"
            placeholder="请输入自定义 API 地址（OpenAI 兼容格式）"
          />
          <p class="settings-hint">例如：https://your-api.com/v1</p>
        </div>

        <div style="margin-top: 16px">
          <button id="test-model-connection" class="test-btn">
            🔗 测试连接
          </button>
        </div>

        <div
          id="model-test-result"
          class="test-result"
          style="display: none"
        ></div>

        <!-- API 获取指南 -->
        <div class="api-guide">
          <p class="api-guide-title">📚 API Key 获取指南</p>
          <ul class="api-guide-list">
            <li>
              <a href="https://platform.deepseek.com/" target="_blank"
                >DeepSeek 开放平台</a
              >
            </li>
            <li>
              <a href="https://platform.moonshot.cn/" target="_blank"
                >Kimi 开放平台</a
              >
            </li>
            <li>
              <a href="https://dashscope.console.aliyun.com/" target="_blank"
                >阿里云百炼 (通义千问)</a
              >
            </li>
            <li>
              <a href="https://console.volcengine.com/ark" target="_blank"
                >火山引擎方舟平台</a
              >
            </li>
            <li>
              <a href="https://open.bigmodel.cn/" target="_blank"
                >智谱 AI 开放平台</a
              >
            </li>
          </ul>
        </div>
      </div>

      <!-- ============================================
           简历解析 API 配置
           ============================================ -->
      <div class="section settings-section api-section">
        <h4 class="api-title">简历解析 API 配置</h4>
        <p class="settings-hint" style="margin-top: -8px; margin-bottom: 16px">
          用于解析 PDF/DOCX 格式的简历文件
        </p>

        <div class="form-group">
          <label for="parse-api-url">API URL</label>
          <input
            type="text"
            id="parse-api-url"
            placeholder="请输入简历解析 API 的 URL 地址"
          />
          <p class="settings-hint">
            示例：https://xxx.cn-hangzhou.aliyuncs.com/resume/parse
          </p>
        </div>

        <div class="form-group">
          <label for="parse-app-code">APP Code</label>
          <input
            type="password"
            id="parse-app-code"
            placeholder="请输入 APP Code"
          />
          <p class="settings-hint">购买 API 服务后获取的 APP Code</p>
          <p class="settings-hint">
            参考：<a
              href="https://market.aliyun.com/detail/cmapi034316"
              target="_blank"
              class="settings-link"
              >简历解析 API</a
            >
          </p>
        </div>
      </div>

      <button id="save-settings" class="save-settings-btn">💾 保存设置</button>

      <!-- ============================================
           使用说明卡片
           ============================================ -->
      <div class="usage-guide">
        <h4>📖 使用说明</h4>
        <ul>
          <li data-step="1">
            填写简历信息，系统会<strong>自动保存</strong>您的输入
          </li>
          <li data-step="2">
            或点击"保存"按钮<strong>手动保存</strong>您的信息
          </li>
          <li data-step="3">切换到目标网站页面，点击"预填"快速填充表单</li>
          <li data-step="4">
            可通过"导出"功能备份简历数据（支持 JSON/LaTeX/提示词）
          </li>
          <li data-step="5">配置"简历解析 API"以启用智能简历解析功能</li>
          <li data-step="6">配置"AI 模型"以启用简历内容优化功能（可选）</li>
          <li data-step="7">设置会自动保存，无需手动点击保存按钮</li>
        </ul>
      </div>
    </div>

    <!-- ============================================
         JavaScript 文件引入
         按模块顺序加载，确保依赖关系正确
         ============================================ -->
    
    <!-- ============================================
         新架构：核心模块（必须最先加载）
         ============================================ -->
    <script src="core/namespace.js"></script>
    <script src="config/constants.js"></script>
    <script src="config/fieldConfig.js"></script>
    <script src="core/EventBus.js"></script>
    <script src="core/EventManager.js"></script>
    <script src="services/StorageService.js"></script>
    <script src="services/NotificationService.js"></script>
    <script src="factories/DynamicItemFactory.js"></script>
    
    <!-- ============================================
         旧代码：工具模块（保持兼容）
         ============================================ -->
    <script src="utils/helpers.js"></script>
    <script src="utils/notification.js"></script>
    <script src="utils/storage.js"></script>
    <script src="utils/form.js"></script>
    <script src="utils/api.js"></script>
    <script src="utils/model-api.js"></script>
    <script src="utils/latex-export.js"></script>
    <script src="utils/prompt-export.js"></script>

    <!-- ============================================
         组件模块
         ============================================ -->
    <script src="components/mode-tabs.js"></script>
    <script src="components/dynamic-items.js"></script>
    <script src="components/resume-upload.js"></script>

    <!-- ============================================
         处理器模块
         ============================================ -->
    <script src="handlers/auto-save.js"></script>
    <script src="handlers/action-buttons.js"></script>
    <script src="handlers/field-fill-buttons.js"></script>
    <script src="handlers/add-buttons.js"></script>

    <!-- ============================================
         数据加载器
         ============================================ -->
    <script src="data-loader.js"></script>

    <!-- ============================================
         主入口文件（最后加载）
         ============================================ -->
    <script src="popup.js"></script>
  </body>
</html>


